<!DOCTYPE html>
<html>
  <head>
    <title>An Introduction to servant</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }

      table, th, td {
        border: 1px solid black;
        padding: 3px;
        font-family: monospace;
      }
      table {
        border-collapse: collapse;
      }

    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# An Introduction to `servant`

Sönke Hahn

Functional Thursday, 2. 6. 2016

Mozilla Space, Taipei

---

# Agenda

- Write Your Own `servant`
- Combinators & Interpretations
- The real `servant` packages
- Demo

---

class: center, middle

# Please, ask questions!

---

# Write Your Own `servant-docs`!

Starting small!

--

- `Get`
- paths
- `:<|>`

---

# Write Your Own `servant-server`!

- `Get`
- paths
- `:<|>`
--

- QueryParam

---

# Combinators

<table>
  <tr>
    <th style="opacity: 0.0;"> HasServer </th>
    <th> Get </th>
    <th> path :> api </th>
    <th> :<|> </th>
    <th> QueryParam name param :> api </th>
  </tr>
</table>

---

# Combinators & Interpretations

<table>
  <tr>
    <th> </th>
    <th> Get </th>
    <th> path :> api </th>
    <th> :<|> </th>
    <th> QueryParam name param :> api </th>
  </tr>
  <tr>
    <th> HasDocs </th>
    <th> </th>
    <th> </th>
    <th> </th>
    <th> </th>
  </tr>
  <tr>
    <th> HasServer </th>
    <th> </th>
    <th> </th>
    <th> </th>
    <th> </th>
  </tr>
</table>

---

# Combinators & Interpretations

<table>
  <tr>
    <th> </th>
    <th> Get </th>
    <th> path :> api </th>
    <th> :<|> </th>
    <th> QueryParam name param :> api </th>
  </tr>
  <tr>
    <th> HasDocs </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
  </tr>
  <tr>
    <th> HasServer </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
  </tr>
</table>

---

# Combinators & Interpretations

<table>
  <tr>
    <th> </th>
    <th> Get </th>
    <th> path :> api </th>
    <th> :<|> </th>
    <th> QueryParam name param :> api </th>
    <th> ... </th>
  </tr>
  <tr>
    <th> HasDocs </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> </th>
  </tr>
  <tr>
    <th> HasServer </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> ✓ </th>
    <th> </th>
  </tr>
  <tr>
    <th> ... </th>
    <th> </th>
    <th> </th>
    <th> </th>
    <th> </th>
    <th> </th>
  </tr>
</table>

Extensibility: We can write new combinators and new interpretations.

---

class: center, middle

# The real `servant` packages

---

# Combinators

| api                       | Server api            | meaning             |
| ------------------------- | --------------------- | ------------------- |
| Get '[JSON] result        | Handler result        | GET method          |
| Post '[JSON] result       | Handler result        | POST method         |
| path :> api               | Server api            | /path               |
| Capture n a :> api        | a -> Server api       | /:n/                |
| Header n a :> api         | Maybe a -> Server api | request header      |
| QueryParam n a :> api     | Maybe a -> Server api | /?n=foo             |
| QueryParams n a :> api    | [a] -> Server api     | /?n=foo&n=bar       |
| QueryFlag n :> api        | Bool -> Server api    | /?n                 |
| ReqBody contentTypes a    | a -> Server api       | request body        |
| Raw                       | Application           | escape hatch        |
| ...                       | ...                   | ...                 |

--

We don't have separate packages for external combinators yet.

---

# Interpretations

- [servant-server](http://hackage.haskell.org/package/servant-server)
- [servant-client](http://hackage.haskell.org/package/servant-client)
- [servant-swagger](http://hackage.haskell.org/package/servant-swagger)
- [servant-js](http://hackage.haskell.org/package/servant-js)
- [servant-elm](http://hackage.haskell.org/package/servant-elm)
- [servant-mock](http://hackage.haskell.org/package/servant-mock)
- [servant-quickcheck](http://hackage.haskell.org/package/servant-quickcheck)
- ...

---

# Demo

using
- servant-server
- servant-elm
- servant-client (for testing)

fixme: try out how long it takes

fixme: write better demo (with servant-swagger)

---

class: center, middle

# Thanks for your attention!

Getting started: [github.com/haskell-servant/example-servant-minimal](https://github.com/haskell-servant/example-servant-minimal)

    </textarea>
    <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
